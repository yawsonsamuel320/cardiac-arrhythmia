# cardiac-arrhythmia
This repository houses code for detection and classification of cardiac arrhythmia


**1)	Data source**                           
ECG signals from the MIT-BIH Arrhythmia Database were the dataset used in this approach in training the machine learning model. It contains 48 recordings from 47 participants with each recording having a duration of 30 minutes [11]. Each ECG signal has an annotation file which labels its respective R peaks according to their respective types of heartbeats. Each signal was pre-processed by passing them through a baseline wander removal algorithm and a Butterworth band-pass filter to remove noise from artefacts.

Each signal was then split with a sampling rate of 300 into its respective R peaks to create a dataset of features corresponding with their respective labels from the annotation files. Samples annotated as non-beat types and those with null values in their annotations were dropped from the dataset resulting in a dataset of 109383 heartbeats ranging across 14 heartbeat types (13 arrhythmic classes and 1 normal class). The arrhythmia classes now included paced beat, atrial premature contraction, ventricular escape beat, fusion of ventricular and normal beat, nodal (junctional) premature beat, left bundle branch block, right bundle branch block, supraventricular premature beat, premature ventricular contraction, aberrated atrial premature beat, atrial escape beat, the fusion of paced and normal beat and nodal (junctional) escape beat, together with a class for normal heartbeat.

**2)	Feature engineering**      
Daubechies wavelet transform (with an order of 8 and level of 4) was the feature extraction technique used to produce the indicators or biomarkers from which the machine learning model could accurately detect and characterize various arrhythmias. The level 4 (A4) and the level 3 and 4 detail coefficients (D4 and D3) per heartbeat were all concatenated into one dataset as seen in Figure 2.2. Then, feature creation was performed using the independent component analysis (ICA) method. ICA was used to create 18 extra features in addition to the 114 morphological features obtained from the wavelet transform. The final step in the model training pipeline was feature selection using the principal component analysis method. This dimensionality reduction technique was used to reduce the number of component features to 26 which is to minimize the size of the machine model while maintaining optimum accuracy. After the development of the machine learning model pipeline, features were extracted for understandability and interpretability. These included the QRS complex, P waves, T waves, PR intervals, Heart rate and QT interval.

**3)	Model Training, Testing and Evaluation**      
The model used was a support vector classifier. The validation set obtained after feature engineering comprised of 20% of the dataset while the remainder was used for model training. The dataset was finally scaled before the model was fitted on it. The model performance was evaluated on the validation set. The results obtained are as seen in the table below. The overall sensitivity, specificity and accuracy obtained from the validation set were 97% (97 out of 100 arrhythmic heartbeats correctly classified), 100% (all normal heartbeats correctly classified) and 98% (98 out of 100 normal or arrhythmic heartbeats correctly classified).
Table 1 shows the precision, recall and number of beat occurrences obtained for each of the 13 arrhythmia classes and one class for normal heartbeat type. For example, in the case of the paced beat, the number of samples present in the test dataset was 1395. Out of these, the machine-learning algorithm was correct 99% of the time when it predicted that a heartbeat was a paced beat (i.e., the precision of 99%) and out of all 1395 paced beats the algorithm correctly classified 99% of them (i.e., recall of 99%).
